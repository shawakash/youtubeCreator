(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[827],{5974:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/videos/assigned/[assignedId]",function(){return t(9019)}])},9019:function(e,s,t){"use strict";t.r(s),t.d(s,{__N_SSP:function(){return g}});var o=t(2322),r=t(2784),a=t(1655),n=t(5632),i=t(3476),d=t(4330),u=t(5546),l=t(2382),p=t(2202),c=t(3542),g=!0;s.default=(0,a.Z)(e=>{let{video:s}=e,t=(0,n.useRouter)(),{assignedId:a}=t.query,[g,h]=(0,r.useState)(),[m,f]=(0,r.useState)(),[v,y]=(0,i.FV)(d.lp),S=(0,i.sJ)(d.Di),A=(0,r.useRef)(null),{NEXT_PUBLIC_BASEURL:_}=c.env,T=(0,i.Zl)(d.Z_);return(0,r.useEffect)(()=>{s||(p.Am.error("Server Error"),t.back()),s&&(f(s),h(s.isUploaded))},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"h-full  bg-gray-100 flex justify-around py-6",children:[m&&(0,o.jsx)(u.cB,{video:m,type:"raw",clientId:S,client:"editor",page:"video"}),(0,o.jsx)("div",{className:"flex flex-col gap-y-8",children:m&&(0,o.jsx)(u.MX,{video:m,fileRef:A,type:"assigned",propData:e=>{let s=A.current;s&&(0,l.Z)({baseURL:"http://localhost:3001/api",url:"/video/getPutSignedUrl",method:"GET",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("editorToken"),key:e.videoKey,bucketname:"creator-edit-video"}}).then(o=>{200==o.status&&(0,l.Z)({url:o.data.presignedUrl,method:"PUT",data:s.files[0],headers:{"Content-Type":s.type}}).then(s=>{200==s.status&&(0,l.Z)({baseURL:"http://localhost:3001/api",url:"/video/addEditVideo",method:"POST",data:e,headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("editorToken")}}).then(e=>{200==e.status&&(T(s=>[...s,e.data.video]),p.Am.success(e.data.message),t.push("/videos/edit"))}).catch(e=>{e?e.response&&403==e.response.status?(p.Am.error(e.response.data.message),sessionStorage.clear(),t.push("/login")):401==e.response.status&&(p.Am.error("Please first allow us your youtube access"),t.push("/auth")):e.response&&p.Am.error(e.response.data.message),console.log(e)})}).catch(e=>{e?e.response&&(403==e.response.status||401==e.response.status)&&(p.Am.error(e.response.data.message),sessionStorage.clear(),t.push("/login")):e.response&&p.Am.error(e.response.data.message),console.log(e)})}).catch(e=>{e?e.response&&(403==e.response.status||401==e.response.status)&&p.Am.error(e.response.data.message):e.response&&(p.Am.error("Video Uploading Error, Aws"),p.Am.error(e.response.data.message)),console.log(e)})}})})]})})})},1655:function(e,s,t){"use strict";var o=t(2322),r=t(2382),a=t(5632),n=t(2784),i=t(2202),d=t(3542);s.Z=e=>s=>{let t=(0,a.useRouter)(),{BASEURL:u}=d.env,l=async()=>{(0,r.Z)({baseURL:u||"http://localhost:3001/api",url:"/auth/me",method:"GET",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("editorToken")}}).then(e=>{e.data.isValid||(i.Am.error(e.data.message),sessionStorage.clear(),t.push("/login"))}).catch(e=>{e&&!e.response.isValid&&(i.Am.error(e.response.data.message),sessionStorage.clear(),t.push("/login"))})};return(0,n.useEffect)(()=>{sessionStorage.getItem("editorToken")&&0!=sessionStorage.getItem("editorToken").length?l():(sessionStorage.clear(),t.push("/login"))},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(e,{...s})})}}},function(e){e.O(0,[382,774,888,179],function(){return e(e.s=5974)}),_N_E=e.O()}]);
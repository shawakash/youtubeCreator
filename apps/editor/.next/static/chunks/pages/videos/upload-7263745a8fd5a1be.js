(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[99],{4011:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/videos/upload",function(){return t(7835)}])},7835:function(e,s,t){"use strict";t.r(s);var o=t(2322),a=t(2382),r=t(5632),n=t(2784),i=t(2202),l=t(3476),u=t(4330),d=t(1655),c=t(5546),p=t(3542);s.default=(0,d.Z)(()=>{let e=(0,n.useRef)(null),s=(0,n.useRef)(null),t=(0,l.Zl)(u.K3),d=(0,r.useRouter)(),{BASEURL:g,AWS_RAW_VIDEO_BUCKET_NAME:h}=p.env,m=async s=>{let o=e.current;if(o){let e=new Date().toISOString().replace(/[-:.]/g,""),r="".concat(s.videoKey,"-").concat(e);s.videoKey=r,(0,a.Z)({baseURL:g||"http://localhost:3001/api",url:"/video/getPutSignedUrl",method:"GET",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("editorToken"),key:r,bucketname:s.bucketName}}).then(e=>{200==e.status&&(0,a.Z)({url:e.data.presignedUrl,method:"PUT",data:o.files[0],headers:{"Content-Type":o.type}}).then(e=>{200==e.status&&(0,a.Z)({baseURL:g||"http://localhost:3001/api",url:"/video/addEditCredential",method:"POST",data:s,headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("editorToken")}}).then(e=>{200==e.status&&(t(t=>[...t,{...s,creator:e.data.creator,editor:e.data.editor,isUploaded:!1,isEdited:!0}]),i.Am.success(e.data.message),d.push("/videos/edit"))}).catch(e=>{e?e.response&&403==e.response.status?(i.Am.error(e.response.data.message),sessionStorage.clear(),d.push("/login")):401==e.response.status&&(i.Am.error("Please first allow us your youtube access"),d.push("/auth")):e.response&&i.Am.error(e.response.data.message),console.log(e)})}).catch(e=>{e?e.response&&(403==e.response.status||401==e.response.status)&&(i.Am.error(e.response.data.message),sessionStorage.clear(),d.push("/login")):e.response&&i.Am.error(e.response.data.message),console.log(e)})}).catch(e=>{e?e.response&&(403==e.response.status||401==e.response.status)&&(i.Am.error(e.response.data.message),sessionStorage.clear(),d.push("/login")):e.response&&i.Am.error(e.response.data.message),console.log(e)})}else console.warn("No video selected for upload.")};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"h-screen bg-gray-100 flex justify-center items-center",children:(0,o.jsx)(c.kj,{propData:m,type:s,fileRef:e,client:"editor"})})})})},1655:function(e,s,t){"use strict";var o=t(2322),a=t(2382),r=t(5632),n=t(2784),i=t(2202),l=t(3542);s.Z=e=>s=>{let t=(0,r.useRouter)(),{BASEURL:u}=l.env,d=async()=>{(0,a.Z)({baseURL:u||"http://localhost:3001/api",url:"/auth/me",method:"GET",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("editorToken")}}).then(e=>{e.data.isValid||(i.Am.error(e.data.message),sessionStorage.clear(),t.push("/login"))}).catch(e=>{e&&!e.response.isValid&&(i.Am.error(e.response.data.message),sessionStorage.clear(),t.push("/login"))})};return(0,n.useEffect)(()=>{sessionStorage.getItem("editorToken")&&0!=sessionStorage.getItem("editorToken").length?d():(sessionStorage.clear(),t.push("/login"))},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(e,{...s})})}}},function(e){e.O(0,[382,774,888,179],function(){return e(e.s=4011)}),_N_E=e.O()}]);
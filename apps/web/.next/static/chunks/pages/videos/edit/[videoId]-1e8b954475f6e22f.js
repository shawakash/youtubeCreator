(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[400],{5325:function(e,s,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/videos/edit/[videoId]",function(){return o(9938)}])},9938:function(e,s,o){"use strict";o.r(s),o.d(s,{__N_SSP:function(){return p}});var t=o(2322),r=o(2784),a=o(5632),n=o(5546),i=o(3476),l=o(4330),c=o(2202),d=o(2382),u=o(509),p=!0;s.default=(0,u.Z)(e=>{let{leger:s}=e,[o,u]=(0,r.useState)(),p=(0,a.useRouter)(),h=(0,i.Zl)(l.K3),g=(0,i.Zl)(l.Lz),m=(0,r.useRef)();return(0,r.useEffect)(()=>{s||(c.Am.error("Server Error"),p.back()),s&&u(s)},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"h-screen bg-gray-100 flex justify-around items-center",children:[o&&(0,t.jsx)(n.cB,{video:o,type:"edit",clientId:o.creator._id,client:"creator",onDelete:()=>{(0,d.Z)({baseURL:"http://localhost:3000/api",url:"/video/delete",method:"DELETE",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("creatorToken"),videoKey:o.videoKey,type:"edit",bucketname:o.bucketName}}).then(e=>{h(e=>e.filter(e=>e._id!=o._id)),c.Am.success(e.data.message),p.push("/videos/edit")}).catch(e=>{e?e.response&&403==e.response.status?(console.clear(),console.log(e),c.Am.error(e.response.data.message)):401==e.response.status&&(c.Am.error("Please first allow us your youtube access"),p.push("/auth")):e.response&&c.Am.error(e.response.data.message),console.log(e)})},page:"video"}),(0,t.jsx)("div",{className:"",children:o&&(0,t.jsx)(n.MX,{client:"creator",video:o,tagsRef:m,type:"edit",propData:e=>{(0,d.Z)({baseURL:"http://localhost:3000/api",url:"/video/update",method:"PUT",headers:{Authorization:sessionStorage.getItem("creatorToken"),"Content-Type":"application/json",type:"edit",videoKey:o.videoKey,bucketName:o.bucketName},data:e}).then(s=>{h(s=>{let t=s.find(e=>e.videoKey==o.videoKey);return t={...t,...e},s}),u(s=>({...s,...e})),c.Am.success(s.data.message)}).catch(e=>{e?e.response&&403==e.response.status?(c.Am.error(e.response.data.message),sessionStorage.clear(),p.push("/login")):401==e.response.status&&(c.Am.error("Please first allow us your youtube access"),p.push("/auth")):e.response&&c.Am.error(e.response.data.message),console.log(e)})},propUpload:e=>{console.log(e),(0,d.Z)({baseURL:"http://localhost:3000/api",url:"/video/upload",method:"POST",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("creatorToken")},data:e}).then(s=>{h(s=>{let t=s.find(e=>e.videoKey==o.videoKey);return(t={...t,...e}).isUploaded=!0,console.log(t),s}),u(s=>(s.isUploaded=!0,console.log(s),{...s,...e})),g(s=>{let t=s.find(e=>e.videoKey==o.videoKey);return(t={...t,...e}).isUploaded=!0,console.log(t),s}),c.Am.success("Video Uploaded SuccessFully to Youtube")}).catch(e=>{if(e.response){let s=e.response.data.message;(s&&s.includes("Auth First")||s.includes("Token Expired"))&&(c.Am.error(s),p.push("/auth")),!1===e.response.data.isAuth&&(c.Am.error("Session Expired, Please Login In"),p.push("/login")),c.Am.error(e.message),console.error(e)}})}})})]})})})},509:function(e,s,o){"use strict";var t=o(2322),r=o(2382),a=o(5632),n=o(2784),i=o(2202),l=o(3542);s.Z=e=>s=>{let o=(0,a.useRouter)(),{BASEURL:c}=l.env,d=async()=>{(0,r.Z)({baseURL:c||"http://localhost:3000/api",url:"/auth/me",method:"GET",headers:{"Content-Type":"application/json",Authorization:sessionStorage.getItem("creatorToken")}}).then(e=>{e.data.isValid||(i.Am.error(e.data.message),sessionStorage.clear(),o.push("/login"))}).catch(e=>{e&&!e.response.isValid&&(i.Am.error(e.response.data.message),sessionStorage.clear(),o.push("/login"))})};return(0,n.useEffect)(()=>{sessionStorage.getItem("creatorToken")&&0!=sessionStorage.getItem("creatorToken").length?d():(sessionStorage.clear(),o.push("/login"))},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(e,{...s})})}}},function(e){e.O(0,[382,774,888,179],function(){return e(e.s=5325)}),_N_E=e.O()}]);